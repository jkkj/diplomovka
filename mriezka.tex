\chapter{Konštrukcia mriežky}
\begin{defin}
Mriežka veľkosti $ n \times m$ je graf $P_{n} \times P_{m}$
\end{defin}
\begin{defin}
Cyklická mriežka veľkosti $n \times m$ je graf $C_{n} \times C_{m}$.
\end{defin}

V tejto kapitole sa budeme zaoberať mriežkou a cyklickou mriežkou. Na to, aby sme sa v
týchto dvoch grafoch dokázali dobre orientovať, zavedieme pojem dimenzie a
jej súradnice. Pričom využujeme, že oba grafy sú produktmi kartézskeho
súčinu. Výsledky v tejto kapitole môžu byť užitočné pri hľadaní konštrukcií
grafov, ktoré sú výsledkom kartézskyh súčinov zložitejších grafov. Cesta a
cyklus totiž patria medzi najjednoduchšie podgrafy.

\begin{ozn}
Pojem dimenzie v produkte kartézskeho súčinu $G$, grafov $U$ a $V$ 
zavedieme prirodzene vzhľadom
na označenie vrcholov produktu ako usporiadanej dvojice $(u,v)$, kde $u \in
U$ a $v \in V$. i-tou dimenziou vrchola produktu tohto súčinu bude i-ty člen
tejto dvojice. Súradnicou v dimenzii i je prvok na i-tej pozícii v
usporiadanej dvojici. Pre zjednodušenie označíme vrcholy pôvodných grafov
prirodzenými číslami od 1 po m respektíve od 1 po n. Vrcholy produktu
kartézskeho súčinu týchto dvoch grafov budú pre dosť veľké m,n napríklad
$(2,4)$, $(5,17)$, $(9,1)$, atď.
\end{ozn}

\begin{pozn}
Pri mriežke a cyklickej mriežke budeme číslovať vrcholy pôvodných grafov
tak, aby sa označenia susedných vrcholov líšili o jedna, v prípade cyklickej
mriežky budú v pôvodných grafoch - cykloch spojené aj vrcholy 1 a n,
repektíve 1 a m.
\end{pozn}

Nasledujúcu lemu budeme používať neskôr. Hovorí o tom, že ak mriežka má oba
rozmery väčšie ako tri, agent pri konštrukcii každej hrany vykoná najmenej
tri pohyby. Cyklická mriežka s rozmerom dva nemôže existovať, lebo by
obsahovala násobné hrany. Pokiaľ má cyklická mriežka niektorý rozmer tri,
tak vie agent niektoré jej hrany skonštruovať na dva kroky. Hrany, 
ktoré pri tom
prejde však musia byť buď kostrové alebo ich skonštruuje na tri kroky. Toto
je veľmi špeciálny prípad.

\begin{lem}
Pri konštrukcii portovej hrany v mriežke aj v cyklickej mriežke, ktorá
nemá žiaden rozmer menší ako štyri, 
urobí agent medzi otvorením prvého a druhého
portu najmenej tri kroky.
\end{lem}
\begin{proof}
Najmenší cyklus v oboch grafoch má dĺžku štyri. 
Teda medzi otvorením dvoch portov
hrany vykoná agent najmenej tri pohyby po hranách. Buď prejde po už
existujúcich alebo vytvorí nové operáciou NH.
\end{proof}

\section{Jedna značka pre porty}

Z výsledkov pre konštrukciu cyklickej mriežky v prípade, keď má agent k
dispozícii len jednu značku pre port, je najdôležitejšie zistenie, že pri
konštrukcii musí agent pri niektorej z portových hrán od otvorenia prvého po
otvorenie jej druhého portu prejsť po všetkých súradniciach okrem tej, v
ktorej táto hrana vedie. Toto platí pre obe dimenzie.

Pre konštrukciu mriežky s jednou značkou pre porty sme dokázali, že sa dá
skonštruovať na tri kroky pre každý port plus agent vykonal navyše $m-1$
krokov, kde m je menší z rozmerov. Vyslovili sme hypotézu, že na menej
krokov to nie je možné. Aj keď sa nám ju nepodarilo uspokojivo dokázať,
urobili sme viacero zaujímavých pozorovaní.

Teraz nasledujú prípravné lemy k týmto výsledkom. Pripomenieme, že pojem
tvoriaci cyklus portovej hrany označujenajmenší cyklus obsahujúci danú hranu
vybraný zo sledu, ktorý agent prešiel medzi otvorením jej prvého a druhého
portu.

Pri dokazovaní výsledku o cyklickej mriežke využijeme fakt, že nahradením
hrany v tvoriacom cykle s párnym počtom výskytov ostatných súradníc sa nemení 
ich parita. Pokiaľ sa teda zmení, musela byť nahrádzaná hrana s nepárnym
počtom výskytov ostatných súradníc v tvoriacom cykle a tento nepárny výskyt
musel agent $"$odšľapať$"$.


\begin{lem}
Kostrové hrana je staršia, vznikla skôr, ako všetky portové hrany incidentné
s jej mladším koncovým vrcholom.
\end{lem}
\begin{proof}
Aby agent mohol otvoriť vo vrchole port, musel už tento vrchol existovať.
Jediná operácia ktorou mohol vrchol vzniknúť je operácia NH. Mladší vrchol
vznikol spolu s kostrovou hranou a preto doň predtým nemohli viesť žiadne
hrany.
\end{proof}


\begin{lem}
Tvoriaci cyklus hrany $h$ obsahuje len hrany staršie ako $h$.
\end{lem}
\begin{proof}
Tvoriaci cyklus obsahuje hrany, po ktorých agent prešiel, keď konštuoval
hranu $h$. Museli teda v čase po prechode agenta už existovať a sú preto 
staršie ako hrana $h$, ktorú agent vytvoril až potom, ako po týchto hranách
prešiel.
\end{proof}


\begin{lem}
\label{cyklus}
Každý tvoriaci cyklus je možné nahradiť tvoriacim cyklom, ktorý obsahuje len
hrany kostry a príslušnú portovú hranu.
\end{lem}
\begin{proof}
Majme tvoriaci cyklus hrany $h$. Každú portovú hranu, okrem $h$  v ňom nahradíme 
jej tvoriacim
cyklom, až kým nemáme uzavretý sled na kostrových hranách a hrane $h$. Z
neho vieme vybrať tvoriaci cyklus hrany $h$.
\end{proof}


Teraz si zavedieme pojem dimenzie v kartézskom súčine, čo budeme potrebovať
pri mriežke aj cyklickej mriežke.

\begin{ozn}
Graf prislúchajúci dimenzii d grafu G je d-ty činiteľ kartézskeho súčinu, 
ktorého je G produktom.
\end{ozn}

\begin{ozn}
Hrana v mriežke a cyklickej mriežke vedie medzi dvomi vrcholmi, 
ktoré sa líšia v práve jednej dimenzii a v tejto majú súradnice vrcholov,
ktoré spolu susedia v grafe, ktorý prislúcha danej dimenzii. Teda ak je to
prvá dimenzia jedná sa o prvý člen kartézskeho súčinu a ak je to druhá
dimenzia o druhý. Súradnica hrany budeme volať súradnicu k, ak k je
najvyššia súradnica v danej dimenzii a hrana spája vrcholy s najnižšou a
najvyššou súradnicou dimenzie, alebo nižšia zo súradníc v ktorých sa líšia
vrcholy spojené touto hranou.

Hranu so súradnocou k budeme volať niekedy hrana v súradnici k. Rovnako
budeme používať pojem dimenzia hrany a hrana dimenzie.
\end{ozn}
\begin{ozn}
Prechodom po súradnici budeme volať prechod agenta po hrane danej súradnice.
\end{ozn}

\begin{ozn}
Susedná súradnica k súradnici k v dimenzii d, je každá súradnica vrchola,
ktorý
spája nejaká hrana s vrcholom so súradnicou k 
v grafe prislúchajúcom dimenzii d.
\end{ozn}



\begin{lem}
Portová hrana v súradnici k v cyklickej mriežke má v tvoriacom cykle 
odlišnú paritu počtu prechodov po súradnici k ako majú počty prechodov 
po ostatných súradniciach
V ostatnej dimenzii majú všetky počty prechodov po jednotlivých súradniciach
rovnakú paritu.
\end{lem}
\begin{proof}
Aby otvoril druhý port hrany, agent musí svoju pozíciu zmeniť tak, 
aby sa nachádzal na susednej súradnici v diemnzii v ktorej sa líši s
vrcholom s otvoreným prvým portom v dimenzii kam má viesť konštruovaná hrana.
Keď rozdelíme pohyby agenta medi jednotlivé dimenzie, môžeme jeho pohyb
premietnuť do grafov týchto dimenzií. Budeme teda sledovať len to ako sa
mení tá, ktorá súradnica agenta pri jeho pohybe po tvoriacom cykle.
Keďže vrcholy v ktorých otvára porty sa líšia iba v dimenzii konštruovanej
hrany, v jednej dimenzii majú rovnakú súradnicu. Do grafu tejto dimenzie sa
pohyb agenta premietne ako uzavretý sled, kde skončí vo vrchole, v ktorom
začal.
Poďme spočítať paritu prechodov po jednotlivých súradniciach v slede do
ktorého sa v tomto grafe premietne prechod agenta.  Vezmime tie výskyty toho
istého vrcholu, medzi ktorými sú výskyty len iných vrcholov a to každého 
najviac raz. Takže aké pohyby mohol urobiť agent medzi dvomi najbližšími
návštevami nejakého vrcholu? Mohol sa vrátiť zo susedného vrchola - zo
vzdialenejšieho už nie, lebo susedný, cez ktorý by išiel by sa vyskytol na
tomto slede viackrát ako raz. 
Alebo mohol agent prejsť po ceste, kde cieľom
aj východiskom je tento vrchol. Takáto cesta je buď prázdna alebo obsahuje
všetky iné vrcholy y je to vlastne prejdenie cyklu dookola.
V prvom prípade sa parita prechodov po súradniciach zachová, lebo agent
prešiel tam a spať po rovnakej súradnici. V druhom prípade sa zmení parita
prechodov pre všetky súradnoce. V oboch prípadoch sa teda zachová rovnosť
parít prechodov jednotlivých súradníc, ak platila aj predtým. 
Vieme teda, že medzi dvomi najbližšími výskytmi vrchola sa nič nepokazí. Na
začiatku je počet prechodov pre každú súradnicu rovnaký - nulový a teda majú
rovnakú paritu.Pri ďalšom počítaní môžeme teda tieto výskyty preskočiť -
skontrahovať. Na takto upravenom slede postup opakujeme, až kým nemáme každý
vrchol najviac raz okrem koncového a začiatočného, čo je ten istý. Preň
platia rovnaké pravidlá a teda pre túto dimenziu je veta dokázaná.

V dimenzii konštruovanej hrany sa bude pri otváraní druhého portu nachádzať
vo vrchole susednej súradnice k súradnici vrchola s prvým portom.
Ak pridáme do sledu aj konštruovanú portovú hranu, dostaneme uzavretý sled, pre ktorý
platí predošlý dôkaz. Z toho je jasné, že iba prechody po konštruovanej
hrane majú odlišnú paritu počtu svojich výskytov.
\end{proof}



\begin{veta}
Pri ľubovoľnej konštrukcii cyklickej mriežky G rozmerov $n \times m$ 
s jednou značkou
pre porty, existuje aspoň jedna hrana pri konštrukcii ktorej agent vykoná 
aspoň $n - 1$ krokov v prvej dimenzii
a súčasne aspoň jedna portová hrana,
 pri konštrukcii ktorej agent vykoná aspoň $m - 1$ krokov v druhej dimenzii,
môže ísť o tú istú hranu.
\end{veta}
\begin{proof}
Ako sme už povedali kostrové hrany sú hrany, ktoré vznikli operáciou NH a
tieto hrany tvoria kostru grafu; ako bolo spomenuté grafom nazývame každý
medziprodukt konštrukcie počnúc počiatočným vrcholom až po konečný
skonštruovaný graf.

Každej konštrukcii grafu G zodpovedá nejaká kostra z kostrových hrán. Počet
krokov, ktoré agent vykonal pri konštrukcii hrany h je súčet počtu krokov do
vrchola v, v ktorom otvoril prvý port hrany a počet krokov z vrchola v do
vrchola u, v ktorom otvoril druhý port hrany, 
tento sled z u do v tvoria s portovou
hranou uzavretý sled. Tento sled obsahuje tvoriaci cyklus danej portovej
hrany.

Majme ľubovoľnú konštrukciu cyklickej mriežky $G$ a k nej zodpovedajúcu
kostru. Ukážeme, že pre ňu platí tvrdenie vety.
Táto kostra určuje aj to, ktoré hrany grafu sú portové - tie, ktoré nie sú v
kostre. Pripomeňme si, že kostra zodpovedajúca konštrukcii je kostra tvorená
práve všetkými hranami, ktoré vznikli operáciami NH.

Ukážeme, že existuje aspoň jedna hrana, ktorej tvorivý cyklus bez tejto
hrany obsahuje jej
súradnicu párny počet krát - teda ostatné súradnice v tejto dimenzii nepárny
počet krát. Rovnako to dokážeme pre obe dimenzie. Možné sú dva prípdy, buď
ide o dve rôzne hrany, alebo o jedinú hranu.
Keďže agent musel prejsť do susednej súradnice vrchola s prvým portom hrany
a nemohol tak urobiť v jej súradnici, musel prejsť po všetkých ostatných
súradniciach a teda vykonať aspoň n-1 respektíve m-1 krokov v prípade, že
platí alternatíva s dvomi rôznymi hranami. Alebo n+m - 1 ak platí
alternatíva s jedinou hranou. 


Pozrieme sa na ľubovoľnú kostru. V tejto kostre sa nachádzajú všetky vrcholy
grafu. Aký je tvorivý cyklus jednotlivých portových hrán. V tvorivom cykle
portovej hrany $h$
je možné nahradiť niektorú portovú hranu jej tvorivou cestou. Takýmto
nahrádzaním postupne vieme nahradiť všetky portové hrany. Keď z výsledného
sledu vyberieme konštrukčnú cestu, tento už obsahuje iba kostrové hrany.
Pozrime sa na paritu počtu prechodov jednotlivých súradníc v tejto ceste.
Tvrdíme, že ak sme nenahrádzali hranu, ktorej tvorivá cesta obsahovala
súradnicu tejto hrany párny počet krát, výsledná tvorivá cesta na
kostrových hranách bude obsahovať nepárny počet prechodov po súradnici 
hrany $h$.
Toto je zrejmé. Ak výskyt hrany nahradíme cestou, kde sa táto hrana nachádza
nepárny počet krát, počet prechodov po súradnici hrany sa nezmení. Toto
zároveň implikuje, že prechody po ostatných súradniciach sa na tejto ceste
nachádzajú párny počet krát zvlášť pre každú súradnicu. Teda nezmení sa ani
parita prechodov po ostatných súradniciach.
Čo sa týka parít počtov prechodov v ostatnej dimenzii, tak tu platí to isté,
ak nahrádzame hranu jej tvorivou cestou, kde je počet prechodov po súradnici
tejto hrany párny, tak aj vo výslednom slede je počet prechodov párny pre každú
súradnicu tejto dimenzie.

Keďže výsledný sled, krorý vznikol nahradením tvorivej cesty portovej hrany
$h$ vedie len po kostrových hranách a na tých neexistuje cyklus, tvorivá
cesta hrany $h$ vybraná z tohto sledu zachováva paritu prechodov po
jednotlivých súradniciach takú, aká je v tomto slede.
Kostra je totiž strom a ak sa na slede vyskytne dvakrát ten istý vrchol, tak
medzi dvomi jeho susednými výskytmi je párny výskyt prechodov po
jednotlivých súradniciach a teda ho môžeme zo sledu vybrať - skontrahovať na
jeden výskyt tohoto vrchola. Jediná šanca ako pri pohybe po strome navštíviť
opätovne niektorý vrchol je vrátiť sa doň.

Na kostre existuje pre každú portovú hranu jediná tvorivá cesta, inak by na
nej bol cyklus, čo je spor.
Vezmime si teraz dimenziu $d$ a vrcholy, ktoré majú v ostatnej dimenzii
rovnakú súradnicu, označme ju $k$. Indukovaný podgraf na týchto vrcholoch je
cyklus. Niektoré jeho hrany sú kostrové, ostatné sú portové. Pokiaľ má každá
portová hrana tvorivú cestu na kostre s nepárnym počtom prechodov po jej
súradnici, existuje na kostre cyklus, čo je spor.
Tento cyklus získame z uzavretého sledu vytvoreného z indukovaného grafu
týchto vrcholov, kde portové hrany nahradíme ich tvorivými cestami na
kostre. Vo výslednom slede sa každá hrana bude nachádzať nepárny počet krát
a teda v ňom existuje cyklus, ktorý minimálne raz prejde po každej súradnici
danej dimenzie.

Z toho vyplýva, že niektorá nahrádzaná hrana mala tvorivú cestu s párnym
počtom prechodov po jej súradnici.
Teda pre každú dimenziu existuje hrana, ktorej tvorivá cesta obsahuje
nepárne počty prechodov po súradniciach tejto dimenzie. A agent pri jej
konštrukcii musí vykonať aspoň $n - 1$ krokov pre prvú dimenziu a $m - 1$
iných  krokov pre druhú dimenziu.
\end{proof}


\begin{veta}
Mriežku $m \times n$ je možné s použitím jedinej značky pre port zostrojiť
pomocou $3m(n - 1) + m$ pohybov, kde $m <= n$.
\end{veta}
\begin{proof}
Agent vykonáva: OP,NH,NH,NH,OP,(n-2)krát (OP,S1,NH,NH,OP),S1,NH,HN,OP čím
vytvorí prvý riadok mriežky. Následne vykoná
(m-1)krát (NH,OP,S1,S2,NH,OP,(n-1)krát (OP,S1,S2,NH,OP))
\end{proof}


Domnievame sa, že ide o optimum. Teda že neexistuje konštrukcia, pri ktorej
agent používa jedinú znakču pre porty a vykoná menej krokov.

\begin{proof}
\iffalse
Pokrytie jednou dlaždicou stojí minimálne tri kroky plus cesta do vechola
prvého portu. Dĺžka tejto cesty závisí od polohy agenta v predošlej
dlaždici, jeho polohy v novej dlaždici a od vzájomnej polohy týchto dlaždíc. 

Vzhľadom na dimenzie môžeme určiť štyri smery pohybu v grafe. Podľa toho, či
súradnica v danej dimenzii stúpa alebo klesá.

Pri konštrukcii na tri kroky agent príde do vrchola s druhým portom a otvorí
ho v inej dimenzii ako je tá v ktorej prišiel. Agent sa pohol v smere
portovej hrany.
Ak agent konštruuje dlaždice tak, že dve po sebe skonštruované majú jednu 
hranu spoločnú - jedna z dvoch ktoré vedú do vrchola s druhým portom
predošlej portovej hrany, tak si zachováva smer v oboch dimenziách - stojí 0
krokov, každá zmena smeru stojí 1 krok.

Chceme konštrukciu na čo najmenej krokov. Teda hľadáme takú postupnosť
dlaždíc, ktorou vie agent pokryť mriežku, že stojjí konštrukcia tejto
postupnosti čo najmenej krokov.
Čím sú od seba dlaždice ďalej, tým viac agent vykoná krokov pri ich
konštrukcii, lebo medzi skonštruovaním týchto dlaždíc musí prejsť ich
vzdialenosť.
Ak agent vzápätí po konštrukcii dlaždice konštruuje ďalšiu, stojí ho pohyb
medzi nimi 0 krokov. V tomto prípade sa tieto dlaždice dotýkajú rohmi.
Ak niektorá dlaždica susedí s dvomi kockami spojenými rohom a konštruovanými
hneď po sebe, je výhodnejšie vsunúť túto dlaždicu v konštrukcii medzi tieto
dve. (Toto určite platí o dlaždiciach na okraji mriežky a odtiaľ sa to dá
preniesť vyššie indukciou)
Susedné kocky teda majú spoločný nielen roh ale aj hranu. Agent skončí na
jednom z koncov portovej hrany. Portová hrana môže byť len na okraji
pokrytej plochy.
Po konštrukcii novej dlaždice sa agent ocitne v rovnakom rohu ako bol v
predošlej dlaždici keď otváral prvý port portovej hrany novej dlaždice (keď
z predošlej dlaždice odchádzal najkratšou cestou - pokiaľ portová hrana
nesusedila s dlaždicou bude v susednom vrchole).
TODO treba rozobrať všetky prípady najkratších ciest konštrukcie novej
dlaždice ...
Tam ukážeme susednosti ... tj. ktoré hrany sa opaltí vyberať ako portové ...
(treba použiť argument o najkratšej konštrukcii, ak by portová hrana nemala
susediť s predošlou dlaždicou, musí urobiť kroky navyše, ak všetky vrcholy
dlaždice sú incidentné so 4 hranami, buď som skončil alebo sa niečo pokazilo
... ak dokazujeme konštrukciu postupne, do takéhoto stavu sa snáď
nedostaneme ...) 
\fi
\begin{ozn}
Okraje mriežky sú vrcholy, ktoré majú jednu súradnicu buď minimálnu alebo
maximálnu. Rohy mriežky sú vrcholy, ktoré majú maximálne alebo minimálne obe
svoje súradnice.
Rohy mriežky majú stupeň dva a vrcholy na okraji, ktoré nie sú rohmi, majú
stupeň tri.
Zvyšné vrcholy majú stupeň štyri a voláme ich vnútorné
\end{ozn}

Keď prvý raz príde agent do vrchola, tak hrana po ktorej prišiel musí byť
kostrová.
Každé prerušenie ťahu tvoreného portovými hranami, znamená, že agent okrem
krokov medzi otvorením prvého a druhého portu niektorej portovej hrany,
musel vykonať aspoň jeden krok navyše, keď nebol otvorený žiadny port. 
Počet krokov, ktoré prešiel medzi konštrukciami dvoch hrán, nazvime 
cena prerušenia. Budeme za ňu počítať aj všetky kroky, ktoré vykoná medzi
otvorením dvoch portov rovnakej hrany, ktoré presahujú počet tri kroky na
portovú hranu. Toto nám umožní dať prednosť portovej hrane, konštruovanej na
tri s následným jedným krokom pre otvorením portu nasledujúcej hrany, pred
portovou hranou konštruovanou na päť krokov medzi konštrukciou jej dvoch
portov.

Čím je menšia suma cien všetkých prerušení, na tým menej krokov agent
skonštruoval mriežku.
Vieme, že na každú portovú hranu musí agent vykonať aspoň tri kroky, tiež
sme dokázali horný odhad potrebných krokov.

Prerušenie určite vznikne vo vrcholoch, ktoré majú nepárny počet portových
hrán. Teda všetky vnútorné vrcholy, ktoré sú listami kostry tvoria
prerušenia.

Pokiaľ agent skonštruoval hranu na tri kroky medzi otvorením jej portov,
potom do vrchola s druhým portom príde agent po inej dimenzii, ako je tá,
v ktorej vedie portová hrana. Ak agent pri konštruovaní portových hrán príde
do okrajového vrchola má dve možnosti: buď preruší konštruovanie portových
hrán alebo bude pokračovať po okraji. Každý súvislý ťah na okraji teda
vytvára prerušenie a stojí aspoň jeden krok navyše.

Keďže vnútorné vrcholy sú stupňa štyri, ťah porotvých hrán sa nemôže v
žiadnom vrchole pretínať, pretože každý vrchol má aspoň jednu hranu kostrovú.
Taktiež v rohu je buď porotvý ťah prerušený, alebo doň porotvá hrana
nevedie, v tom prípade však vedie do aspoň jedného s ním susedného vrchola a
teda na okraj.

Poďme sa teraz pozrieť na okraje. Roh na okraji má stupeň tri, z čoho jedna
hrana je nutne kostra. má teda tri možnosti: buď cez neho ťah porotvých hrán
prechádza, porotvý ťah v ňom má koniec, portový ťah doň nevedie - má všetky
tri incidentné hrany kostrové.

Pokiaľ sa nám podarí dokázať, že na veľa okrajových vrcholov pripadá
prerušenie, dostaneme dolnú hranicu. Teda nemusí byť nutne v nich, ale že 
každému z nich viem priradiť iné. Aby sme dokázali, že nami predstavená
horná hranica je aj dolnou, potrebujeme zarátať prerušenia aspoň $2m$
vrcholom, kde $m$ je menší z rozmerov.

Portový ťah keď už vedie po okraji, tak z neho môže odísť len ak
$"$zaplatí$"$ aspoň dva kroky navyše. Na tri kroky totiž môže pokračovať len
po okraji. Teda každému ťahu idúcemu po okraji môžeme zarátať jedno aspoň
prerušenie.

\begin{ozn}
Úsekom vrcholov ozančujeme množinu vrcholov, ktoré majú jednu dimenziu
rovnakú a tvoria ťah.

Úroveň je množina vrcholov s ronakou súradnicou v niektorej dimenzii.
\end{ozn}

Ak agent prišiel do vrchola na okraji, cez ktorý prechádza ťah, a neotvoril
v ňom port, tak urobil dva kroky navyše, môžeme ich teda vynechať. Teda vrchol
na okraji, cez ktorý prechádza ťah, bol skonštruovaný aj so svojou kostrovou 
hranou tesne pred otvorením portov pre ťahy v ňom. Z toho vyplýva, že
vnútorný vrchol, s ktorým susedí, mal predtým stupeň tri alebo v ňom bolo
prerušenie. Toto platí o všetkých vnútorných vrcholoch susediacich s ťahom
na okraji; rátame susedov tých okrajových vrcholov, kde obe portové hrany
idú po okraji. Teda máme úsek vnútorných vrcholov, ktoré boli stupňa tri
alebo v nich je prerušenie.


Ak tieto vrcholy neexistovali pred konštrukciou
ťahu po okraji, tak teraz sú stupňa tri a majú tri kostrové hrany. Teda
štvrtá je buď kostrová alebo je v nich prerušenie.
Všetky vrcholy, ktoré už existujú sú v kostre, lebo vznikli operáciou NH a
touto operáciou sa môže agent dostať do vrchola raz. Ak teda existuje v
grafe úsek
vrcholov, ktoré sú stupňa tri potom do neho budú viesť kostrové hrany alebo
portové. Každá porotvá je jedno prerušenie, pretože tieto vrcholy už sú
stupňa tri. kostrové hrany môžu viesť iba do vrcholov, kotré ešte
neexistujú.

Z úseku ešte neskonštruovaných vrcholov, ktorý susedí s úsekom vrcholov so
stupňom tri v grafe, môže do tohto úseku viesť kostrová hrana alebo porotvá
hrana. Pričom opäť každá portová hrana znamená prerušenie, lebo z vrcholov,
ktoré už majú stupeň tri nebude môcť ťah pokračovať. Ak z niektorých dvoch
budú viesť kostrové hrany, už nemôže viesť kostrová hrana medzi nimi. Pokiaľ
sú to teda portové vrcholy a nemá v nich byť prerušenie, musí viesť kostrová
hrana do druhého susedného úseku. Zvyšné dve hrany sú potom portové a tvoria
ťah. Z tohto tiež vidno, ktorý úsek vznikol skôr a môžeme ich teda rozlíšiť
podľa veku.

Poďme teraz hľadať prerušenia k vrcholom na  okraji mriežky. 
Chceme ich nájsť $2m$ rôznych. Ak
k okrajovému vrcholu nie sú prerušenia má, ako sme ukázali vyššie, 
dve možnosti: 
buď ide portový ťah cez neho alebo cez je icidentný s tromi kostrovými
hranami. Inak mu priradíme prerušenie ťahu v ňom. Medzi každým úsekom
vrcholov s tromi kostrovými hranami je na okraji prerušenie. Na každý úsek
ťahu na okraji pripadá jedno prerušenie.


TODO
\iffalse
Vrcholov podľa druhého prípadu nevytvárajúcich prerušenia je obmedzene veľa.
Ak totiž podgraf kostry spojený na hranu idúcu do vnútra mriežky neobsahuje
vrchol s nepárnym počtom portových hrán, musí mať všetky listy na okraji.
Na každý takýto podgraf teda pripadá minimálne jeden list na okraji a teda
prípad dva môže platiť pre najviac polovicu vrcholov na okraji. Ukážeme, že
v optimálnej konštrukcii je to menej.

V treťom prípade platí, že ak agent konštuuje portové hrany a príde do
vrchola na okraji otvoriť port, tak na tri kroky otvorí port opäť len na
okraji (ak je to možné). Teda až do prerušenie vedie ťah z portových hrán už
len po okraji.

Je zrejmé, že spolu môžu susediť len rovnaké prípady alebo prvý prípad s
ľubovoľným iným a druhý prípad s tretím ak to bude "prechod ťahu na okraj".

Tiež vidno, že ak by v treťom prípade boli vnútorné vrcholy navštívené prvý
krát, išli by z nich tri kostrové hrany. Potom by v nich bolo buď prerušenie
alebo by z nich musela vychádzať štvrtá kostrová hrana.

Ak má agent skonštruovať hranu na tri kroky, musí hrana v rovnakej súradnici
o jedna ďalej buď existovať alebo byť kostrová. (Agent nemá k dispozícii
značku pre portovú hranu). Ak je kostrová, musí viesť do ešte nevytvoreného
vrchola.



Hľadáme teda spôsob pokrytia pri ktorom agent vykoná čo najmenej krokov,
keďže počet krokov na dlaždicu je tri a je konštantný, zanedbáme ho.
Najmenej agent potrebuje krokov pokiaľ portová hrana novej dlaždice začína
vo vrchole, kde končí portová hrana predošlej.
Keďže mriežka je osovo symetrická, bez ujma na všeobecnosti, nech skončil v
pravom hornom rohu. Odtiaľ môže na 0 krokov skonštruovať tri rôzne kocky, 
vpravo hore a šikmo hore. Toto je možné len vtedy, ak sú potrebné vrcholy
buď ešte nevytvorené, alebo vhodne spojené s predošlou dlaždicou.
Pozrime sa na šikmý pohyb. 
Pri šikmom pohybe sa mení smer agenta. Ak šikmým pohybom obíde roh mriežky,
bude drahé sa doň vracať. Je výhodnejšie vsunúť ho a vybrať z iného miesta v
postupnosti. Vsunutie stojí 1 krok.
Zmena smeru pri dotyku hranami stojí 1 krok. Ak agent skončí v rohu mriežky,
bude stáť aspoň 1 krok ísť z neho konštruovať novú dlaždicu. Ak nikde doľava
dole sa neoplatí šikmý pohyb, neoplatí sa šikmý pohyb ani tu, argumentácia
podobná ako s rohom mriežky - vrchol šikmo doprava hore od ľavého dolného
rohu má rovnaké postavenie ako ľavý dolný roh... totiž tú kocku, ktorú obíde šikmím pohybom
stojí viac zapojiť do postupnosti ... všetko čo je drahšie ako 1 krok je
drahé. Vľavo dole pod ňou už nie sú šikmé pohyby
Teda šikmý pohyb sa neoplatí. Zmena smeru agenta stojí teda 1 krok. Na
začiatku si agent "môže vybrať" v každej dimenzii ľubovoľný smer, môže totiž
začínať v ľub. rohu prvej dlaždice.
Ak agent konštruuje dlaždicu, ktorá má v niektorej dimenzii z oboch strán
voľné miesta, znamená to, že bude musieť pokryť niektorú stranu a aby sa
dostal do tej druhej, bude musieť meniť smer. Preto je najlepšie ak agent
konštruuje dlaždice tak, aby z dvoch strán mal všetky štvorce pokryté. Teda
začína v rohu, ide po niektorom kraji a konštruuje po pásoch. Na konci vždy
musí zmeniť smer, čo stojí 1 krok. Čím menej je teda pásov, tým	menej musí
agent meniť smer a menej pásov je po väčšej súradnici kocky.
Spôsob konštrukcie mriežky $n \times m$ z vety TODO je optimálny.





Mriežka má štyri rohy. Pri akejkoľvek postupnosti plnenia dlaždicami, môže
na začiatok a koniec minúť len dva z nich, cez zvyšné dva musí teda
prechádzať postupnosť vypĺňania. Bez ujmy na všeobecnosti nech prechádza cez
ľavý dolný roh a príde zľava.


\fi
\end{proof}

\iffalse
\begin{veta}
Pri konštrukcii mriežky je najvýhodnejšie (vzhľadom na počet krokov agenta)
 konštruovať portové hrany tvorivou
cestou dĺžky 3.
\end{veta}
\begin{proof}
Ukážeme, že pre každú kostru existuje taká postupnosť konštrukcie portových
hrán, že ich tvorivá cesta má dĺžku 3. Tvorivá cesta po kostre je pre každú
portovú hranu len jedna. Dajú sa úseky každej takejto tvorivej cesty
postupne nahrádzať portovými hranami, ktorým sú tvorivými cestami tak, aby
na konci mala tvorivá cesta dĺžku tri?
Nie nutne.
Nahradíme všetky vzory iki portovou hranou k.
Tvorivá cesta obkolesuje vrcholy. Tieto tiež sú v kostre a teda kostrové
hrany do nich vedúce sa musia napájať na túto tvorivú cestu.

--TODO
treba ukázať, že aj keď sa vezmú do úvahy presuny, tak sú trojkrokové cesty
výhodnejšie ...
\end{proof}
\fi

\begin{veta}
Na zostrojenie mriežky $m \times n$, kde $m <=  n$ potrebuje agent s jednou
značkou pre porty vykonať aspoň $3m(n - 1) + m$ krokov.
\end{veta}
\begin{proof}
V mriežke pri konštrukcii portovej hrany vykoná agent medzi otvorením jej
prvého a druhého portu najmenej tri kroky. Počet portových hrán je
konštantný a teda sa budeme zaoberať len krokymi, ktoré agent musí urobiť
navyše okrem týchto troch krokov na hranu. Kroky, ktoré agent vykoná medzi
otvorením prvého portu hrany a druhého portu predošlej hrany budeme počítať
do počtu krokov novšej z nich.

Pomenujme si vrcholy mriežky, ktoré majú jednu súradnicu maximálnu alebo
minimálnu ako okraje mriežky, a vrcholy, ktoré majú extrémy v oboch
dimenziách nazveme rohmi. Na jednom okraji ležia všetky vrcholy, ktoré majú
daný extrém rovnako veľký. Roh patrí do oboch okrajov.
Rohy majú stupeň dva a ostatné vrcholy na okrajoch majú stupeň tri.

Ak medzi otvorením druhého portu predošlej hrany a prvého portu hrany
nasledujúcej agent nevykonal žiadny krok, tak tvoria tieto dve hrany spolu
súvislý ťah. Pod ťahom portových hrán budeme rozumieť v tomto dôkaze takú
postupnosť portových hrán, kde tieto nasledujú podľa poradia svojho vzniku a
agent medzi otvorením portov dvoch susedných hrán nevykonal žiadne ďalšie
kroky.

Tieto ťahy vieme zoradiť podľa poradia vzniku a následne prepojiť pridaním
hrán, ktorá prešiel agent medzi koncom jedného ťahu a začiatko
nasledujúceho do sledu. Medzi dvomi ťahmi mohol agent behať ľubovoľne, ale
keďže hľadáme najkratšiu konštrukciu, môžeme vybrať z tohto sledu ťah.
Pretože ak aj agent skonštruoval nejaké kostrové hrany (portové nemohol,
lebo hovovríme o úseku, kedy ich neskonštruoval), boli to mosty, musel sa z
nich vrátiť a ak sa bude vracať do vrcholov, ktoré vznikli s nimi, bude
musieť po nich prejsť rovnako ako pri konštrukcii. Ic konštrukciu teda môže
vynechať a skonštruovať ich neskôr.

Pri optimalizácii počtu krokov sa snažíme tento "konštrukčný" ťah skrátiť čo
najviac.

Mriežka obsahuje vrcholy stupňa nanajvýš 4. Z toho vyplýva, že ťahy z
portových hrán sa nemôžu križovať v žiadnom vrchole, lebo jeden stupeň
vrchola je určite kostrová hrana. Miesta v konštrukčnom ťahu nezveme
prerušenia. Snažíme sa súčet ich dĺžok minimalizovať, pričom každé má dĺžku
minimálne 1 hrana.

Kostra má konštantný počet hrán. Je to toľko akoby bola ťah s dvomi listami.
Vnútorné vrcholy mriežky (doplnková množina ku krajom) majú stupeň 4. Ak by
do nich viedol nepárny počet portových hrán, boli by to prerušenia
konštrukčného ťahu (miesta, kde v ňom nie sú portové hrany). Teda v ideálnom
prípade do nich vedú dve portové hrany a dve kostrové hrany alebo 4 kostrové
hrany a žiadna portová.

Definujem si v mriežke smery hore, dole, vpravo, vľavo. Vrchol je tým vyššie
čím má väčšiu súradnicu druhej dimenzie a tým viac vpravo, čím má vyššiu
prvú súradnicu.

Mriežka má dva vrcholy. Cez tieto nemôže prechádzať portový ťah, pretože
majú stupeň dva. Ak sa agent dostane na okraj mriežky a vytvorí doň portovú
hranu, môže buď prerušiť ťah, alebo konštruovať portový ťah vedúci ďalej už
len po okraji. Agent totiž na tri kroky príde do vrchola po hrane inej
dimenzie ako konštruuje portovú hranu. Keď teda príde prvý raz do portového
vrchola i skonštruuje doň jednu portovú a jednu kostrovú hranu, ostane mu
"voľná" - dosiaľ neskonštriovaná len hrana po okraji. ďalšie dve možnosti
pre vrchol na okraji sú, aby doň viedli tri kostrové hrany, alebo v ňom bolo
prerušenie. Ak cez vrchol na okraji vedú dve portové hrany, kostrová hrana,
ktorá doň vedie musela vzniknúť pri ich konštrukcii, inak by to bola
zbytočná zachádzka agenta dĺžky minimálne dva kroky (tam a späť), keby ju
vynechal, nič by sa nepokazilo, lebo agent do tohto vrchola musí prísť
rovnakou hranou. Teda vrchol z ktorého táto kostrová hrana vedie, musel mať
o jednu hranu menej.

Ak do vrchola stupňa 4 vedú práve tri kostrové hrany je v ňom prerušený portový
ťah. Ak po okraji vedie portový ťah, tak do vrcholov stupňa 4 z ktorých vedú do
týchto okrajový vrcholov kostrové hrany, mali pred jeho konštrukciou stupeň
max. 3 a teda sa správali ako okrajvé vrcholy. Sú to vrcholy susediace s
vrcholmi tohto ťahu okrem jeho začiatočného a koncového vrchola.

Pomenujme skonštruovanou plochou tú časť mriežky, ktorá už je skonštruovaná
a jej okraje a rohy definujme rovnako ako pri mriežke. Je zrejmé, že ak
medzi niektoré dva jej okrajové vrcholy bude treba skonštruvať hranu po tom,
ako ich agent opustí, v oboch koncoch tejto hrany bude mať konštrukčný ťah 
prerušenie. Teda všetky vrcholy, ktoré ešte neboli vytvorené a v cieľovom
grafe susedia s aktuálnym okrajom skonštruaovanej plochy, budú buď
prerušením, alebo z nich pôjdu do týchto susedov kostrové hrany. Keby to
boli portové, nastalo by v týchto vrcholoch prerušenie, lebo už majú tri
hrany zo štyroch a my hľadáme konštrukciu, v ktorej budú len tie
najnutnejšie prerušenia s čo najkratšou celkovou sumou. Ťah teda ide vždy po
okraji skonštruovanej plochy.

Agent musí niekde začať a vytvoriť tak prvú portovú hranu. Od tejto hrany
vieme odvodiť akési vrstvy podľa toho, ako sa súradnica danej hrany líši od
súradnice prvej portovej hrany smerom ku krajom do všetkých štyroch 
definovaných smerov.
Ukázali sme, že pre dosiahnutie čo najmenšieho počtu prerušení konštrukčného
ťahu je výhodné, aby bližšie vrstvy boli staršie. Najstaršou vrstvou v danom
smere sú teda hrany vedúce po okraji. Pozrime sa na okraj, na ktorom bola
skonštruovaná posledná portová hrana. Každý portový ťah na okraji je
najmenej jedno prerušenie, najmenší počet prerušení, ktoré sa dajú pre daný
okraj dosiahnuť je teda jedno.

Najmenej prerušení pri okraji, po ktorom vedie ťah, dosiahneme, ak bude
súvislý a bude prechádzať cez čo najviac hrán na okraji. Aby bol počet
prerušení čo najmenší, ťah bude končiť v rohu mriežky. Začať môže buď v rohu
alebo v jeho susednom vrchole. V prvom prípade je jasné, že bol ťah z
portových hrán prerušený, ôebo cez roh nemôže prechádzať. V druhom prípade
sú dve možnosti, buď vedie do príslušného rohu portová hrana po druhom
okraji a vtedy je tiež prerušenie, alebo vedú do rohu len kostrové hrany a
portový ťah "prišiel na okraj" zo súradnice o jena nižšej portovou hranou v
inej dimenzii. Ukážeme, že ani v tomto prípade nebol neprerušený.

Všimnime si, že ak chce agent skončiť vpravo, musí začať konštruovať vľavo a
naopak.

O úroveň nižšie k prvej portovej hraneto vyzerá podobne ako na okraji,
pretože keď z mriežky odoberieme graf indukovaný týmto ťahom po okraji
vedeným na čo najmenej prerušení, dostaneme buď mriežku o jednu dimenziu
nižšiu alebo takú mriežku s jedným "štvorčekom prilepeným v rohu", nazvyme
si ho výbežok. Mriežku v
jednej dimenzii o jedna menšiu vyriešime rrekurzívne. V tom druhom prípade
vieme, že ťah  po jednej jeho
strane smerujúcej od zvyšku mriežky musí ísť. Ťah môže bez prerušenia ísť po
okraji zvyšku mriežky, podísť výbežok a po jeho okraji skončiť v rohu
konštruovaného grafu, kde sa preruší. Druhá možnosť je ísť až po výbežok a
po jeho druhej - tej bližšej strane hore. V prvom prípade je situácia
rovnaká ako pri mriežke o jedna nižšej, lebo keď odoberieme túto ďalšiu
"vrstvu" ťahu máme rovnaké možnosti. V druhom prípade však máme útvar s
jedným ďalším výbežkom, pričom ťah o úroveň vyššie ide tentokrát na duhom
konci. Teda agent, aby minimalizoval počet krokov, musí skonštruovať výbežok 
a potom zvyšok okraja. Keby tam výbežok nebol, tak o úroveň vyššie by sme
mali dve možnosti - výbežok bez prerušenia alebo "rovný okraj" (agent skončí
v rohu) s prerušením. Keď výbežok máme prerušenie sa predĺži. Výbežok má
totiž dva rohy, ak agent skončí v bližšom, budem to mať o jedna k začiatu
ďalšej portovej hrany, ale buď sa na začiatok tejto portovej hrany dostane
na krok navyše, alebo o úroveň nižšie bude výbežok. Ak však skončí vo
vzdialenejšom, bude to síce bez výbežku, ale na dva kroky od prvého portu
nasledovnej hrany.

Takže sme si ukázali, ako sa dá skonštruovať okraj na čo najmenej prerušení a aké
to má následky na konštrukciu zvyšných častí mriežky. Pri takejto
konštrukcii môžu byť všetky vnúttorné vrcholy konštruované bez prerušení,
lebo verzia s výbežko nič neušetrí a tak môže ťah pohodlne končiť na okraji
mriežky. Takže, ak sa má jeden okraj zaobísť bez prerušení, musia byť
prerušenia na tom druhom až po úroveň prvej portovej hrany. Vlastne prvá
portová hrana v tomto prípade je najlepšie na súradnici o jedna vyššie ako
dolný okraj (bez ujmy na všeobecnosti konštruujeme horný okraj mriežky
jedným ťahom). Keby bola vyššie, agent by po skonštruovaní hrán nižšie od
nej sa musel vracať hore, čo sú kroky navyše.

Prerušenia, ktoré vzniknú pri takejto konštrukcii majú dĺžku jeden krok a je
ich toľko ako je veľká dimenzia (koľko má súradníc), v ktorej nekonštruujeme
okraj jedným ťahom z portových hrán. Teda je výhodné týmto spôsobom
konštruovať dlhší okraj mriežky.

Pre úplnosť chýba argumentácia, prečo ide portový ťah po celom okraji a či
nie je možné ušetriť kroky prerušenia jeho skrátením na tomto okraji.
Skracovať, či prerušovať ho niekde v strede nemá zmysel, boli by to kroky
navyše. Aj po skrátení vyzerajú vrstvy pod súvislým ťahom rovnako, môžu sa
skracovať smerom do stredu mriežky bez prerušenia najviac však o jedno na
každej strane (vždy vznikne výbežok a treba "okraj" nižšej úrovni
skonštruovať na čo najmenej krokov), pretože ako sme už spomínali, tvoria
tieto hrany na nižšej úrovni "okraj".

Prerušenia, ktré môžeme ušetriť ležia na oboch zvyšných okrajoch. Ušetrenie
takéhoto prerušenia by znamenalo, že cez niektoré vrcholy tohto okraja by
museli ísť dve portové hrany, alebo žiadna. Tiež sme ukázali, že ak spolu
susedia vrcholy, ktoré majú stupeň o jedna nižší ako v cieľovom grafe,
 a hrana medzi nimi ešte nie je skonštruovaná, znamená to prerušenie a cestu
agenta cez aspoň jednu hranu tam a jednu odtiaľ (keďže už oba existujú
nemôže to byť kostrová hrana). Susedstvo vrcholov na okraji kde jeden má dve
portové hrany a druhý žiadnu znamená, že ten s kostrovými hranami je starší
a kostrová hrana vedúca z neho do vrchola s dvomi portovými vznikla spolu s
ním až potom, ako bol úsek okraja bez portových hrán hotový.

Zároveň platí že vrcholy susediace s okrajovými vrcholmi bez portových hrán
nesmú byť navzájom spojené kostrovými hranami a taktiež to, že sú mladšie
ako tie okrajové a po dokončení tejto časti okraja majú stupeň tri. To
znamená na každý vrchol, ktorého sused do ktorého má viesť štvrtá hrana
existuje, prerušenie. Keby úsek okrajových vrcholov bez portových hrán
susedil z oboch strán s úsekmi s portovými hranami. Jeden z nich by musel
byť skonštruovaný skôr ako druhý a z neho by sa agent musel dostať ku
konštrukcii toho druhého, čo by stálo minimálne toľko ako keby boli portove
hrany v týchto ťahoch konštruované tak, aby vrstvy pribúdali len jedným
smerom.

Keby mladšia vrstva bola širšia ako tá pod ňou, vytvárala by pre vrstvy
priradené k druhému okraju rovný bok a prechod na ňom medzi vrstvami stojí
aspoň jeden krok navyše, ako sme si ukázali. Čím viac by sa teda zužovali,
tým plytšie by bola najstaršia z nich, ale tým viac by bolo prechodov ceny
aspoň jedna pri vrtvách susedného okraja., čiže sa to neoplatí.

Keby medzi vrstvami prechádzal agent bez medzikrokov, tak by vznikol výbežok
do boku, čo by prerušilo danú vrstvu príslušného susedného okraja a pridalo
jeden krok. Teda by sme nič neušetrili.

Pozrime sa na jednu vrstvu, či už otočenú portovými hranami hore alebo dole
(na vrchnejšej alebo spodnejšej strane). Vieme, že od nej mladšie vrstvy sa
nebudú zužovať a staršie rozširovať bez pridania prerušení a tým aj krokov.

Nech susedia dva okraje, ktoré obsahujú vrcholy bez prerušenia. Vrstvy
smerom k stredu kocky, ktoré sú pod nimi sa musia zužovať, alebo medzi nimi
dochádza k prerušeniam. Ak na ich hranici sú "schody" tj oba sa zužujú o
jedno smerom do stredu, môže agent na tomto ich spoji prechádzať medzi
vrstvami bez prerušenia. Problém, ktorý vytvorí kroky navyše je, že keď
agent skonštruuje najmladšiu vrstvu na okraji mriežky, musí prejsť smerom do
stredu do najstaršej vrstvy susedného kraja, čo sú kroky navyše. Ide podľa
toho ako veľmi sa zužovali vrstvy susedného okraju, čím menej, tým je
najstaršia vrstva bližšie. Ak sa však nezužovali, má okraj týchto vrstiev
okraj plný výbežkov so vzdialenosťou jedna medzi dvomi susednými a keďže je
to minimálne jedno prerušenie na výbežok a šetrili sme ním prerušenie dĺžky
jedna, neušetrili sme nič..

Ak by sa vrstvy rozširovali rýchlešie, mal by susedný okraj pre svoje  vrstvy
rovný bok, čo stojí minimálne prerušenie dĺžky jedna na prechod medzi
vrstvami. Ak majú tri okraje portové ťahy, tak sa vedia zbiehať po jednom
smerom do stredua ten medzi nimi bude mať najstaršiu vrstvu v polke svojej
šírky od seba. Ak by agent konštruoval vrstvy okrajov portupne, tj. najprv.
všetky jedného okraja a potom druhého atď., tak by vždy skončil na okraji a
musel by minimálne trikrát ísť do stredu, čo je o cca polovicu viac ako
výsledok z vety a teda sa to neoplatí. Ak by agent tieto vrstvy konštruoval
postupne, teda najprv všetky štyri najstaršie atď., stálo by ho to jeden
krok na prechod medzi dvomi vrstvami, čo sa opäť neoplatí. Agent by tu
nemohol využiť "bezplatné" prechody medzi vrstvami.

Z toho všetkého vyplýva, že optimum pri konštukcii mriežky je skonštruovať
na jedom okraji ťah z portových hrán, na druhom okraji tejto diemnzie sa
bude vetviť kostra a na zvyšných dvoch budú končiť ťahy z portových hrán.
Stojú to tri kroky na každú portovú hranu plus počet vrstiev mínus jedna,
teda menší z rozmerov kocky mínus jedna.
\end{proof}



\iffalse
Mriežka $m \times n$ má $2*(m+n) - 4$ vrcholov nepárneho stupňa. Tvoriacu
cetu portovej hrany v mriežke tvoria tri hrany. Agent teda musí na
konštrukciu ľubovoľnej portovej hrany vykonať aspoň tri kroky, keďže má k
dispozícii len jednu značku pre porty.
Ďalšie kroky agent vykonáva, keď sa pohybuje po grafe a nie je otvorený
žiadny port. Preto najväčší možný počet portových hrán na daný počet krokov 
tvorí agent vtedy, keď konštruuje portovú hranu na tri kroky a v tom istom
vrchole otvorí port pre novú hranu. Takto vie konštruovať každé tri kroky
jednu portovú hranu. Lenže. Keďže v tomto prípade jedna portová hrana začína
tam, kde predošlá končí, tvoria ťah. Aby teda bolo možné týmto spôsobom
skonštruovať všetky portové hrany mriežky, musely by sa jej hrany dať 
rozdeliť na kostru a ťah. Mriežka má však priveľa vrcholov nepárneho stupňa
na to, aby bolo takéto rozdelenie možné.
Tieto vrcholy buď sú koncami ťahu tvoreného portovými hranami alebo je veľká
časť z nich 
listami kostry. Súčet stupňov vrcholov kostry je konštantný vzhľadom na
počet jej vrcholov a pri mriežke to je $2 * (mn - 1)$. Vrcholy mriežky majú
stupeň najviac 4. Každý vrchol musí byť súčasťou kostry a teda ak tvoria
portové hrany súvislý ťah, môže tento prechádzať vrcholom najviac raz. Jeho
konce môžu byť v dvoch vrcholoch stupňa 4, ktorými tento ťah prechádza.
Všetky ostatné vrcholy stupňa 4 by teda museli mať v kostre stupeň 2. Je ich $(m -
1) * (n -1)$. Vrcholy na jednom okraji mriežky môžu mať stupeň tri, potom
ale tie na opačnom musia byť listami, inak by bol v kostre cyklus, keďže
medzi nimi sa nachádzajú len vrcholy stupňa 4. Vrcholy na zvyšných dvoch
krajoch môžu mať buď stupeň dva, potom ale portové hrany netvoria súvislý
ťah, alebo na každý list na nich je jeden z nich stupňa tri, čo by bolo v
spore s tým, že vrcholy stupňa 4 majú v kostre stupeň 2. Lebo jeden z troch
susedov krajných vrcholov má stupeň 4.

...
Treba maximalizovať počet vrcholov incidentných s nejakou dvojicou portových
 hrán a minimalizovať počet krokov, ktré agent vykoná od vtedy, keď dokončí
jeden ťah po vtedy, kým začne ďalší.

Teda vlastne minimalizujeme počet krokov, ktoré agent vykoná mezi
jednotlivými konštrukciami portových hrán. Ak vieme maximalizovať počet
vrcholov, do ktorých vedú dve portové hrany a všetky ostatné medzery vie
agent prejsť na jeden krok, ide o optimum.

...
Nie po každej kostre sa dá výhodne konštruovať mriežka ...
napr. pre 3 x 3 existuje kostra, kde portové hrany tvoria ťah, ale nedajú sa
podľa neho konštruovať ...

Konštrukcia vyžaduje, aby tri hrany po ktorých prejde agent pri konštrukcii
portovej hrany buď už existovali alebo boli kostrové ...

agent vytvorí prvú portovú hranu ... ak skončí vo vrchole ktorý má v
konštruovanom grafe stupeň:
- dva - tento už má dve hrany, agent v ňom nemôže otvoriť port ani NH
- tri - agent môže otvoriť port, alebo vykonať NH v opačnom prípade sa sem
- musí vrátiť ...
- štyri - agent môže otvoriť port

...
Ako sa správa konštrukcia na okrajoch mriežky?
\fi

